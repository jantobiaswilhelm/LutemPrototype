<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lutem - AI-Powered Gaming Recommendations</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/pages/calendar.css">
    
    <!-- CSS moved to external files: variables.css, themes.css, base.css, components.css, layout.css -->
    
    <!-- FullCalendar JS (v6 has CSS bundled in JS) -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    
    <!-- Demo Mode Scripts (for GitHub Pages) -->
    <script src="games-data.js"></script>
    <script src="demo-mode.js"></script>
</head>
<body>
    <!-- Tab Navigation (Bottom Bar) -->
    <nav class="tab-navigation">
        <div class="tab-container">
            <!-- Logo moved to page header -->
            <div class="tabs">
                <button class="tab-button active" data-page="home">
                    <span class="tab-icon">ğŸ </span>
                    <span>Home</span>
                </button>
                <button class="tab-button" data-page="calendar">
                    <span class="tab-icon">ğŸ“…</span>
                    <span>Calendar</span>
                </button>
                <button class="tab-button" data-page="games">
                    <span class="tab-icon">ğŸ®</span>
                    <span>Games</span>
                </button>
                <button class="tab-button" data-page="profile">
                    <span class="tab-icon">ğŸ‘¤</span>
                    <span>Profile</span>
                </button>
            </div>
        </div>
    </nav>

    <!-- Color Palette Toggle Button -->
    <div class="palette-toggle" id="paletteToggle" title="Change Color Palette">
        <span id="paletteIcon">ğŸ¨</span>
    </div>

    <!-- Palette Selector Menu -->
    <div class="palette-selector" id="paletteSelector">
        <div class="palette-selector-header">Choose Theme</div>
        
        <!-- Light/Dark Mode Toggle -->
        <div class="mode-toggle-container">
            <div class="mode-toggle-btn active" data-mode="light">
                <span>â˜€ï¸</span>
                <span>Light</span>
            </div>
            <div class="mode-toggle-btn" data-mode="dark">
                <span>ğŸŒ™</span>
                <span>Dark</span>
            </div>
        </div>

        <!-- Color Palette Options -->
        <div class="palette-colors">
            <div class="palette-color-option" data-palette="cafe">
                <div class="palette-color-icon">â˜•</div>
                <div class="palette-color-label">Warm CafÃ©</div>
            </div>
            <div class="palette-color-option" data-palette="lavender">
                <div class="palette-color-icon">ğŸ’œ</div>
                <div class="palette-color-label">Soft Lavender</div>
            </div>
            <div class="palette-color-option" data-palette="earth">
                <div class="palette-color-icon">ğŸŒ¿</div>
                <div class="palette-color-label">Natural Earth</div>
            </div>
            <div class="palette-color-option" data-palette="ocean">
                <div class="palette-color-icon">ğŸŒŠ</div>
                <div class="palette-color-label">Ocean Breeze</div>
            </div>
        </div>
    </div>

    <!-- Wizard Toggle Button -->
    <div class="wizard-toggle" id="wizardToggle" title="Quick Start Wizard">
        <span>ğŸ§™</span>
    </div>

    <!-- HOME PAGE (existing content) -->
    <div id="home-page" class="page-content active">

    <!-- Guided Setup Modal -->
    <div class="guided-modal-overlay" id="guidedModalOverlay">
        <div class="guided-modal">
            <div class="guided-modal-header">
                <img src="lutem-logo.png" alt="Lutem" class="logo-small">
                <p id="modalHeaderText">Let's find your perfect game!</p>
            </div>

            <div class="guided-modal-body">
                <!-- Welcome Screen -->
                <div class="guided-question active" id="welcomeScreen">
                    <div class="welcome-choices">
                        <div class="choice-card" onclick="startQuickSetup()">
                            <div class="choice-card-icon">ğŸš€</div>
                            <div class="choice-card-title">Quick Start</div>
                            <div class="choice-card-desc">Answer 4 simple questions</div>
                            <div style="font-size: 0.85em; color: var(--text-light); font-weight: 600;">~40 seconds</div>
                        </div>

                        <div class="choice-card" onclick="useFullForm()">
                            <div class="choice-card-icon">âš™ï¸</div>
                            <div class="choice-card-title">Custom Setup</div>
                            <div class="choice-card-desc">Full control over all options</div>
                            <div style="font-size: 0.85em; color: var(--text-light); font-weight: 600;">~2 minutes</div>
                        </div>
                    </div>
                </div>

                <!-- Question 1: Energy Level -->
                <div class="guided-question" id="question1">
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>

                    <h3 class="question-title">How are you feeling right now?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Choose what matches your current energy</p>

                    <div class="big-options">
                        <div class="big-option" data-value="LOW" onclick="selectBigOption(this, 'guidedEnergy')">
                            <div class="big-option-icon">ğŸ”‹</div>
                            <div class="big-option-label">Low Energy</div>
                        </div>
                        <div class="big-option" data-value="MEDIUM" onclick="selectBigOption(this, 'guidedEnergy')">
                            <div class="big-option-icon">ğŸ”‹ğŸ”‹</div>
                            <div class="big-option-label">Medium Energy</div>
                        </div>
                        <div class="big-option" data-value="HIGH" onclick="selectBigOption(this, 'guidedEnergy')">
                            <div class="big-option-icon">ğŸ”‹ğŸ”‹ğŸ”‹</div>
                            <div class="big-option-label">High Energy</div>
                        </div>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToWelcome()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" id="q1NextBtn" disabled onclick="goToQuestion2()">Next â†’</button>
                    </div>
                </div>

                <!-- Question 2: Time -->
                <div class="guided-question" id="question2">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>

                    <h3 class="question-title">How much time do you have?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Drag the slider to set your available time</p>

                    <div class="big-time-display" id="guidedTimeDisplay">30 minutes</div>
                    <input type="range" id="guidedTimeSlider" min="0" max="7" value="2" step="1" class="big-slider">
                    <div style="display: flex; justify-content: space-between; font-size: 0.9em; color: var(--text-secondary);">
                        <span>5 min</span>
                        <span>3+ hrs</span>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToQuestion1()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" onclick="goToQuestion3()">Next â†’</button>
                    </div>
                </div>

                <!-- Question 3: Mood/Goals -->
                <div class="guided-question" id="question3">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                    </div>

                    <h3 class="question-title">What do you want to feel?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Select one or more that resonate with you</p>

                    <div class="mood-chips-grid">
                        <div class="mood-chip-big" data-value="UNWIND" onclick="toggleMoodChip(this)">ğŸ˜Œ Unwind and relax</div>
                        <div class="mood-chip-big" data-value="PROGRESS_ORIENTED" onclick="toggleMoodChip(this)">ğŸ† Progress Oriented</div>
                        <div class="mood-chip-big" data-value="LOCKING_IN" onclick="toggleMoodChip(this)">ğŸ¯ Locking in</div>
                        <div class="mood-chip-big" data-value="ADVENTURE_TIME" onclick="toggleMoodChip(this)">ğŸ—ºï¸ Adventure Time</div>
                        <div class="mood-chip-big" data-value="CHALLENGE" onclick="toggleMoodChip(this)">âš¡ Challenge Myself</div>
                        <div class="mood-chip-big" data-value="RECHARGE" onclick="toggleMoodChip(this)">ğŸ”‹ Recharge Energy</div>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToQuestion2()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" id="q3NextBtn" disabled onclick="goToQuestion4()">Next â†’</button>
                    </div>
                </div>

                <!-- Question 4: Interruptibility -->
                <div class="guided-question" id="question4">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                    </div>

                    <h3 class="question-title">Can you pause anytime?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Do you need the flexibility to stop whenever needed?</p>

                    <div class="big-options">
                        <div class="big-option" data-value="HIGH" onclick="selectBigOption(this, 'guidedInterruptibility')">
                            <div class="big-option-icon">â¸ï¸</div>
                            <div class="big-option-label">Yes, Anytime</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">Total flexibility</div>
                        </div>
                        <div class="big-option" data-value="MEDIUM" onclick="selectBigOption(this, 'guidedInterruptibility')">
                            <div class="big-option-icon">ğŸ’¾</div>
                            <div class="big-option-label">Some Pauses</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">Are fine</div>
                        </div>
                        <div class="big-option" data-value="LOW" onclick="selectBigOption(this, 'guidedInterruptibility')">
                            <div class="big-option-icon">ğŸ”’</div>
                            <div class="big-option-label">No, I'm Locked In</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">Full commitment</div>
                        </div>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToQuestion3()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" id="q4NextBtn" disabled onclick="submitGuidedSetup()">Get Recommendation ğŸ®</button>
                    </div>
                </div>
            </div>

            <div class="guided-modal-footer">
                <a href="#" onclick="useFullForm(); return false;">Or use the full form for more control â†’</a>
            </div>
        </div>
    </div>

    <!-- Touch Grass Modal -->
    <div class="modal-overlay" id="touchGrassModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸŒ±</div>
            <h2>Time to Touch Grass?</h2>
            <p>3+ hours of gaming is a marathon session!</p>
            <p style="margin-top: 15px; font-weight: 600;">Before you dive in, consider:</p>
            <ul style="text-align: left; margin-top: 10px; padding-left: 20px;">
                <li style="margin: 10px 0; color: var(--text-secondary);">Have you moved your body today?</li>
                <li style="margin: 10px 0; color: var(--text-secondary);">Have you had water recently?</li>
                <li style="margin: 10px 0; color: var(--text-secondary);">Is your space comfortable for a long session?</li>
            </ul>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-secondary" onclick="closeTouchGrassModal(false)">I'll Choose Less Time</button>
                <button class="modal-btn modal-btn-primary" onclick="closeTouchGrassModal(true)">I'm Ready! ğŸ®</button>
            </div>
        </div>
    </div>

    <!-- Page Header with Logo -->
    <div class="page-header">
        <div class="page-header-logo">LUTEM</div>
        <div class="page-header-tagline">Find your perfect game for right now</div>
    </div>

    <div class="container" id="mainContainer">

        <!-- NEW: Single-column Home Wizard -->
        <div class="home-wizard">
            
            <!-- Section 1: Energy Level -->
            <div class="wizard-section">
                <div class="wizard-question">
                    âš¡ How's your energy right now?
                </div>
                <div class="energy-grid" id="energyLevel">
                    <div class="energy-card" data-value="LOW">
                        <div class="energy-card-battery">
                            <div class="battery-fill" style="height: 33%"></div>
                        </div>
                        <div class="energy-card-label">Low Energy</div>
                    </div>
                    <div class="energy-card" data-value="MEDIUM">
                        <div class="energy-card-battery">
                            <div class="battery-fill" style="height: 66%"></div>
                        </div>
                        <div class="energy-card-label">Medium</div>
                    </div>
                    <div class="energy-card" data-value="HIGH">
                        <div class="energy-card-battery">
                            <div class="battery-fill" style="height: 100%"></div>
                        </div>
                        <div class="energy-card-label">High Energy</div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Time Available -->
            <div class="wizard-section">
                <div class="wizard-question">
                    â±ï¸ How much time do you have?
                </div>
                <div class="time-section">
                    <div class="time-value-display" id="timeDisplay">30 min</div>
                    <input type="range" id="timeSlider" min="0" max="7" value="2" step="1" class="discrete-slider">
                    <div class="time-labels">
                        <span>5min</span>
                        <span>15min</span>
                        <span>30min</span>
                        <span>45min</span>
                        <span>1hr</span>
                        <span>2hr</span>
                        <span>3hr</span>
                        <span>3hr+</span>
                    </div>
                </div>
            </div>

            <!-- Section 3: Mood/Emotional Goals -->
            <div class="wizard-section">
                <div class="wizard-question">
                    ğŸ˜Š What do you want to feel?
                    <div class="wizard-question-sub">(select all that apply)</div>
                </div>
                <div class="mood-grid" id="emotionalGoals">
                    <div class="mood-chip" data-value="UNWIND">ğŸ˜Œ Unwind</div>
                    <div class="mood-chip" data-value="PROGRESS_ORIENTED">ğŸ† Progress</div>
                    <div class="mood-chip" data-value="LOCKING_IN">ğŸ¯ Focus</div>
                    <div class="mood-chip" data-value="ADVENTURE_TIME">ğŸ—ºï¸ Adventure</div>
                    <div class="mood-chip" data-value="CHALLENGE">âš¡ Challenge</div>
                    <div class="mood-chip" data-value="RECHARGE">ğŸ”‹ Recharge</div>
                </div>
            </div>

            <!-- Section 4: Interruptibility -->
            <div class="wizard-section">
                <div class="wizard-question">
                    â¸ï¸ Can you pause anytime?
                </div>
                <div class="interrupt-grid" id="interruptibility">
                    <div class="interrupt-card" data-value="HIGH">
                        <div class="interrupt-card-icon">â¸ï¸</div>
                        <div class="interrupt-card-label">Yes</div>
                        <div class="interrupt-card-sub">Flexible</div>
                    </div>
                    <div class="interrupt-card" data-value="MEDIUM">
                        <div class="interrupt-card-icon">ğŸ’¾</div>
                        <div class="interrupt-card-label">Some</div>
                        <div class="interrupt-card-sub">Pauses OK</div>
                    </div>
                    <div class="interrupt-card" data-value="LOW">
                        <div class="interrupt-card-icon">ğŸ”’</div>
                        <div class="interrupt-card-label">No</div>
                        <div class="interrupt-card-sub">Locked in</div>
                    </div>
                </div>
            </div>

            <!-- Main CTA Button -->
            <button class="wizard-submit" id="recommendBtn">
                ğŸ® Get Recommendation
            </button>

            <!-- Advanced Options Toggles -->
            <div class="advanced-section">
                <!-- Genre Preferences Toggle -->
                <div class="advanced-toggle" id="genreToggle">
                    <span class="advanced-toggle-text">
                        <span>ğŸ¯</span>
                        <span>Genre Preferences</span>
                    </span>
                    <span class="advanced-toggle-icon">â–¼</span>
                </div>

                <!-- Advanced Options Toggle -->
                <div class="advanced-toggle" id="advancedToggle">
                    <span class="advanced-toggle-text">
                        <span>âš™ï¸</span>
                        <span>More Options</span>
                    </span>
                    <span class="advanced-toggle-icon">â–¼</span>
                </div>
            </div>

            <!-- Genre Preferences Content (hidden by default) -->
            <div class="advanced-content" id="genreContent">
                <div class="wizard-section" style="margin-top: 16px;">
                    <div class="wizard-question" style="font-size: 1em;">
                        Select genres you enjoy
                        <div class="wizard-question-sub">(ranks them higher in results)</div>
                    </div>
                    <div class="chip-container" id="genrePreferences">
                        <div class="chip" data-genre="RPG">ğŸ—¡ï¸ RPG</div>
                        <div class="chip" data-genre="Action">âš”ï¸ Action</div>
                        <div class="chip" data-genre="Strategy">â™Ÿï¸ Strategy</div>
                        <div class="chip" data-genre="Puzzle">ğŸ§© Puzzle</div>
                        <div class="chip" data-genre="Adventure">ğŸ—ºï¸ Adventure</div>
                        <div class="chip" data-genre="Simulation">ğŸ® Simulation</div>
                        <div class="chip" data-genre="Sports">âš½ Sports</div>
                        <div class="chip" data-genre="Racing">ğŸï¸ Racing</div>
                        <div class="chip" data-genre="Roguelike">ğŸ² Roguelike</div>
                        <div class="chip" data-genre="Card Game">ğŸƒ Card Game</div>
                        <div class="chip" data-genre="Battle Royale">ğŸ¯ Battle Royale</div>
                        <div class="chip" data-genre="Tactical FPS">ğŸ”« Tactical FPS</div>
                        <div class="chip" data-genre="Horror">ğŸ‘» Horror</div>
                        <div class="chip" data-genre="Platformer">ğŸ¦˜ Platformer</div>
                        <div class="chip" data-genre="Sandbox">ğŸ—ï¸ Sandbox</div>
                        <div class="chip" data-genre="Party Game">ğŸ‰ Party Game</div>
                        <div class="chip" data-genre="Board Game">ğŸ² Board Game</div>
                        <div class="chip" data-genre="Management">ğŸ“Š Management</div>
                        <div class="chip" data-genre="Life Sim">ğŸ¡ Life Sim</div>
                        <div class="chip" data-genre="Social Deduction">ğŸ•µï¸ Social Deduction</div>
                        <div class="chip" data-genre="Survival">â›º Survival</div>
                        <div class="chip" data-genre="Co-op Adventure">ğŸ¤ Co-op Adventure</div>
                        <div class="chip" data-genre="Arcade">ğŸ‘¾ Arcade</div>
                        <div class="chip" data-genre="Farming Sim">ğŸšœ Farming Sim</div>
                    </div>
                </div>
            </div>

            <!-- Advanced Options Content (hidden by default) -->
            <div class="advanced-content" id="advancedContent">
                <div class="wizard-section" style="margin-top: 16px;">
                    <div class="wizard-question" style="font-size: 1em;">
                        Time of day
                    </div>
                    <div class="radio-group" id="timeOfDay">
                        <div class="radio-option" data-value="MORNING">Morning</div>
                        <div class="radio-option" data-value="MIDDAY">Midday</div>
                        <div class="radio-option" data-value="AFTERNOON">Afternoon</div>
                        <div class="radio-option" data-value="EVENING">Evening</div>
                        <div class="radio-option" data-value="LATE_NIGHT">Late Night</div>
                    </div>
                </div>
                <div class="wizard-section" style="margin-top: 16px;">
                    <div class="wizard-question" style="font-size: 1em;">
                        How do you want to play?
                    </div>
                    <div class="radio-group" id="socialPreference">
                        <div class="radio-option" data-value="SOLO">Solo</div>
                        <div class="radio-option" data-value="COOP">Co-op</div>
                        <div class="radio-option" data-value="COMPETITIVE">Competitive</div>
                    </div>
                </div>
            </div>

            <!-- Results Container (shown after recommendation) -->
            <div class="results-container" id="resultsPanel">
                <div class="placeholder">
                    <div class="icon">ğŸ®</div>
                    <p>Select your preferences and click "Get Recommendation"</p>
                    <p style="margin-top: 10px; font-size: 0.9em;">We'll find the perfect game for your mood and time!</p>
                </div>
            </div>

        </div> <!-- End home-wizard -->
    </div>

    </div> <!-- End of home-page -->

    <!-- CALENDAR PAGE -->
    <div id="calendar-page" class="page-content">
        <div class="container">
            <header style="margin-top: 40px; margin-bottom: 30px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h1 style="text-align: left; color: var(--text-primary); font-size: 2.5em;">My Calendar</h1>
                        <p style="text-align: left; color: var(--text-secondary); margin-top: 10px;">Plan your gaming sessions and tasks</p>
                    </div>
                    <button style="background: var(--accent-primary); color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: flex; align-items: center; gap: 8px;" 
                            onclick="addTaskEvent()"
                            onmouseover="this.style.background='var(--accent-secondary)'; this.style.transform='translateY(-2px)'"
                            onmouseout="this.style.background='var(--accent-primary)'; this.style.transform='translateY(0)'">
                        <span style="font-size: 1.2em;">â•</span>
                        <span>Add Task</span>
                    </button>
                </div>
            </header>
            
            <!-- Calendar Container -->
            <div style="background: var(--surface); border-radius: 16px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); margin-bottom: 30px;">
                <div id="calendar"></div>
            </div>
            
            <!-- Calendar Legend -->
            <div style="display: flex; gap: 25px; justify-content: center; margin-bottom: 30px;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="width: 20px; height: 20px; background: #7db5d4; border-radius: 6px; display: inline-block;"></span>
                    <span style="color: var(--text-secondary); font-weight: 600; font-size: 0.95em;">ğŸ® Gaming Session</span>
                </div>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="width: 20px; height: 20px; background: #6c757d; border-radius: 6px; display: inline-block;"></span>
                    <span style="color: var(--text-secondary); font-weight: 600; font-size: 0.95em;">ğŸ“‹ Task/Event</span>
                </div>
            </div>
        </div>
    </div>

    <!-- GAMES PAGE -->
    <div id="games-page" class="page-content">
        <div class="container">
            <header style="margin-top: 40px; margin-bottom: 30px;">
                <h1 style="text-align: center; color: var(--text-primary); font-size: 2.5em;">Game Library</h1>
                <p style="text-align: center; color: var(--text-secondary); margin-top: 10px;">Browse all available games</p>
            </header>
            
            <!-- Filter Section -->
            <div style="background: var(--surface); border-radius: 16px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    
                    <!-- Search -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ” Search
                        </label>
                        <input type="text" id="gameSearch" placeholder="Search games..." 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                               background: var(--background); color: var(--text-primary); font-size: 0.95em; transition: all 0.3s;">
                    </div>
                    
                    <!-- Genre Filter -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ¯ Genre
                        </label>
                        <select id="genreFilter" 
                                style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                                background: var(--background); color: var(--text-primary); font-size: 0.95em; cursor: pointer;">
                            <option value="">All Genres</option>
                        </select>
                    </div>
                    
                    <!-- Mood Filter -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ˜Š Mood
                        </label>
                        <select id="moodFilter" 
                                style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                                background: var(--background); color: var(--text-primary); font-size: 0.95em; cursor: pointer;">
                            <option value="">All Moods</option>
                            <option value="UNWIND">ğŸ˜Œ Unwind</option>
                            <option value="RECHARGE">âš¡ Recharge</option>
                            <option value="ENGAGE">ğŸ¯ Engage</option>
                            <option value="CHALLENGE">ğŸ’ª Challenge</option>
                            <option value="EXPLORE">ğŸ—ºï¸ Explore</option>
                            <option value="ACHIEVE">ğŸ† Achieve</option>
                            <option value="ADVENTURE_TIME">ğŸ—ºï¸ Adventure</option>
                            <option value="PROGRESS_ORIENTED">ğŸ“ˆ Progress</option>
                            <option value="LOCKING_IN">ğŸ”’ Focus</option>
                        </select>
                    </div>
                    
                    <!-- Time Filter -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            â±ï¸ Time Available
                        </label>
                        <select id="timeFilter" 
                                style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                                background: var(--background); color: var(--text-primary); font-size: 0.95em; cursor: pointer;">
                            <option value="">Any Duration</option>
                            <option value="0-30">Quick (0-30 min)</option>
                            <option value="30-60">Medium (30-60 min)</option>
                            <option value="60-999">Long (60+ min)</option>
                        </select>
                    </div>
                </div>
                
                <!-- Clear Filters Button -->
                <div style="margin-top: 20px; text-align: center;">
                    <button id="clearFilters" 
                            style="padding: 10px 24px; background: var(--background); color: var(--text-secondary); 
                            border: 2px solid var(--border); border-radius: 10px; cursor: pointer; font-size: 0.95em; 
                            transition: all 0.3s; font-weight: 500;">
                        Clear All Filters
                    </button>
                </div>
            </div>
            
            <!-- Results Count -->
            <div style="margin-bottom: 20px; color: var(--text-secondary); text-align: center; font-size: 0.95em;">
                Showing <span id="gamesCount" style="color: var(--primary); font-weight: 600;">0</span> games
            </div>
            
            <!-- Games Grid -->
            <div id="gamesGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; padding-bottom: 40px;">
                <!-- Games will be inserted here -->
            </div>
            
            <!-- Loading State -->
            <div id="gamesLoading" style="text-align: center; padding: 60px 20px; display: none;">
                <div class="spinner" style="margin: 0 auto 20px;"></div>
                <p style="color: var(--text-secondary);">Loading games...</p>
            </div>
            
            <!-- Empty State -->
            <div id="gamesEmpty" style="text-align: center; padding: 60px 20px; display: none;">
                <div style="font-size: 3em; margin-bottom: 20px;">ğŸ®</div>
                <h3 style="color: var(--text-primary); margin-bottom: 15px;">No games found</h3>
                <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">
                    Try adjusting your filters or search terms
                </p>
            </div>
        </div>
    </div>

    <!-- PROFILE PAGE -->
    <div id="profile-page" class="page-content">
        <div class="container">
            <header style="margin-top: 40px;">
                <h1 style="text-align: center; color: var(--text-primary); font-size: 2.5em;">Your Profile</h1>
                <p style="text-align: center; color: var(--text-secondary); margin-top: 10px;">Customize your gaming experience</p>
            </header>
            
            <div style="max-width: 900px; margin: 40px auto; padding: 0 20px;">
                <!-- User Info Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ‘¤</span>
                        User Information
                    </h2>
                    <div class="profile-card">
                        <div class="user-avatar-container">
                            <div class="user-avatar">
                                <span style="font-size: 4em;">ğŸ‘¤</span>
                            </div>
                            <button class="btn-secondary" style="margin-top: 15px;">Change Avatar</button>
                        </div>
                        <div class="user-info-fields">
                            <div class="form-group">
                                <label>Display Name</label>
                                <input type="text" id="displayName" placeholder="Enter your name" value="Player">
                            </div>
                            <div class="form-group">
                                <label>Gaming Since</label>
                                <input type="text" id="gamingSince" placeholder="Year" value="2015">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Linked Game Libraries Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ®</span>
                        Linked Game Libraries
                    </h2>
                    <div class="profile-card">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            Connect your gaming platforms to get personalized recommendations
                        </p>
                        <div class="library-connections">
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">ğŸŸ¦</span>
                                    <div>
                                        <div class="library-name">Steam</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">â¬›</span>
                                    <div>
                                        <div class="library-name">Epic Games</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">ğŸŸ©</span>
                                    <div>
                                        <div class="library-name">Xbox</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">ğŸŸ¦</span>
                                    <div>
                                        <div class="library-name">PlayStation</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gaming Preferences Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">âš™ï¸</span>
                        Gaming Preferences
                    </h2>
                    <div class="profile-card">
                        <div class="form-group">
                            <label>Preferred Genres</label>
                            <div class="genre-tags">
                                <button class="genre-tag">Action</button>
                                <button class="genre-tag active">RPG</button>
                                <button class="genre-tag">Strategy</button>
                                <button class="genre-tag active">Puzzle</button>
                                <button class="genre-tag">Sports</button>
                                <button class="genre-tag">Simulation</button>
                                <button class="genre-tag">Adventure</button>
                                <button class="genre-tag">Shooter</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Typical Session Length</label>
                            <select id="sessionLength">
                                <option value="5-15">Quick (5-15 min)</option>
                                <option value="15-30" selected>Short (15-30 min)</option>
                                <option value="30-60">Medium (30-60 min)</option>
                                <option value="60+">Long (60+ min)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Engagement Level</label>
                            <select id="engagementLevel">
                                <option value="casual">Casual - Low intensity</option>
                                <option value="moderate" selected>Moderate - Balanced</option>
                                <option value="intense">Intense - High focus</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Gaming Schedule Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ“…</span>
                        Gaming Schedule
                    </h2>
                    <div class="profile-card">
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="calendarSync">
                                <span>Sync with my calendar (Coming Soon)</span>
                            </label>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 8px; margin-left: 28px;">
                                Connect Google Calendar, Outlook, or Apple Calendar to get personalized game suggestions based on your free time
                            </p>
                        </div>

                        <div class="form-group">
                            <label>Preferred Gaming Times</label>
                            <div class="time-preference-grid">
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="morning">
                                    <span>ğŸŒ… Morning (6am-12pm)</span>
                                </label>
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="afternoon" checked>
                                    <span>â˜€ï¸ Afternoon (12pm-6pm)</span>
                                </label>
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="evening" checked>
                                    <span>ğŸŒ™ Evening (6pm-12am)</span>
                                </label>
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="night">
                                    <span>ğŸŒƒ Late Night (12am-6am)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gaming Priorities Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ¯</span>
                        Gaming Priorities
                    </h2>
                    <div class="profile-card">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            What do you value most in your gaming sessions?
                        </p>
                        <div class="priorities-grid">
                            <label class="priority-card">
                                <input type="radio" name="priority" value="relaxation" checked>
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ§˜</div>
                                    <div class="priority-title">Relaxation</div>
                                    <div class="priority-desc">Unwind and destress</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="challenge">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ†</div>
                                    <div class="priority-title">Challenge</div>
                                    <div class="priority-desc">Test your skills</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="social">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ‘¥</div>
                                    <div class="priority-title">Social</div>
                                    <div class="priority-desc">Play with others</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="story">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ“–</div>
                                    <div class="priority-title">Story</div>
                                    <div class="priority-desc">Immersive narratives</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="competition">
                                <div class="priority-content">
                                    <div class="priority-icon">âš”ï¸</div>
                                    <div class="priority-title">Competition</div>
                                    <div class="priority-desc">Ranked matches</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="exploration">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ—ºï¸</div>
                                    <div class="priority-title">Exploration</div>
                                    <div class="priority-desc">Discover new worlds</div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Emotional Goals Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ’­</span>
                        Emotional Goals
                    </h2>
                    <div class="profile-card">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            Select the moods and feelings you want from your gaming sessions
                        </p>
                        <div class="emotional-goals-grid">
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="unwind" checked>
                                <span class="goal-badge">ğŸŒŠ Unwind</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="recharge" checked>
                                <span class="goal-badge">âš¡ Recharge</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="engage">
                                <span class="goal-badge">ğŸ¯ Engage</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="challenge">
                                <span class="goal-badge">ğŸ”¥ Challenge</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="explore">
                                <span class="goal-badge">ğŸ—ºï¸ Explore</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="achieve">
                                <span class="goal-badge">ğŸ† Achieve</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Save Button -->
                <div style="text-align: center; margin: 40px 0;">
                    <button class="btn-primary" onclick="saveProfile()" style="padding: 15px 50px; font-size: 1.1em;">
                        ğŸ’¾ Save Profile
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- EVENT DETAILS MODAL -->
    <div id="eventDetailsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: var(--surface); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 id="eventDetailsTitle" style="color: var(--text-primary); font-size: 1.8em; margin: 0;">Event Details</h2>
                <button onclick="closeEventDetailsModal()" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: var(--text-secondary); padding: 5px 10px; border-radius: 8px; transition: all 0.3s;" 
                        onmouseover="this.style.background='var(--bg-main)'"
                        onmouseout="this.style.background='none'">âœ•</button>
            </div>
            
            <div style="background: var(--bg-main); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 5px;">â° Time</p>
                <p id="eventDetailsTime" style="color: var(--text-primary); font-weight: 600; margin: 0;"></p>
            </div>
            
            <div style="background: var(--bg-main); padding: 15px; border-radius: 12px; margin-bottom: 25px;">
                <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 5px;">ğŸ“ Description</p>
                <p id="eventDetailsDescription" style="color: var(--text-primary); margin: 0;"></p>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="deleteCurrentEvent()" style="background: #f44336; color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                        onmouseover="this.style.background='#d32f2f'; this.style.transform='translateY(-2px)'"
                        onmouseout="this.style.background='#f44336'; this.style.transform='translateY(0)'">
                    ğŸ—‘ï¸ Delete Event
                </button>
                <button onclick="closeEventDetailsModal()" style="background: var(--accent-primary); color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                        onmouseover="this.style.background='var(--accent-secondary)'; this.style.transform='translateY(-2px)'"
                        onmouseout="this.style.background='var(--accent-primary)'; this.style.transform='translateY(0)'">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- MAXIMIZED GAME MODAL (Global - works from all tabs) -->
    <div id="gameMaximizedOverlay" class="modal-overlay" style="display: none;">
        <div class="game-maximized-modal">
            <button class="modal-close-maximized" onclick="closeMaximizedGame()">âœ•</button>
            <div id="maximizedGameContent"></div>
        </div>
    </div>

    <!-- ADD TASK MODAL -->
    <div id="addTaskModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: var(--surface); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color: var(--text-primary); font-size: 1.8em; margin: 0;">Add New Task</h2>
                <button onclick="closeAddTaskModal()" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: var(--text-secondary); padding: 5px 10px; border-radius: 8px; transition: all 0.3s;"
                        onmouseover="this.style.background='var(--bg-main)'"
                        onmouseout="this.style.background='none'">âœ•</button>
            </div>
            
            <form id="addTaskForm" onsubmit="saveTask(event)">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                        ğŸ“‹ Task Title
                    </label>
                    <input type="text" id="taskTitle" required 
                           placeholder="e.g., Team Meeting, Exercise, Study Session"
                           style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                        ğŸ“ Description (optional)
                    </label>
                    <textarea id="taskDescription" rows="3" 
                              placeholder="Add details about your task..."
                              style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em; resize: vertical;"></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px;">
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ• Start Time
                        </label>
                        <input type="datetime-local" id="taskStart" required 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em;">
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ• End Time
                        </label>
                        <input type="datetime-local" id="taskEnd" required 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em;">
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="closeAddTaskModal()" style="background: var(--bg-main); color: var(--text-primary); border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                            onmouseover="this.style.background='var(--border)'"
                            onmouseout="this.style.background='var(--bg-main)'">
                        Cancel
                    </button>
                    <button type="submit" style="background: var(--accent-primary); color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                            onmouseover="this.style.background='var(--accent-secondary)'; this.style.transform='translateY(-2px)'"
                            onmouseout="this.style.background='var(--accent-primary)'; this.style.transform='translateY(0)'">
                        âœ“ Add Task
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- External JavaScript Modules (loaded in dependency order) -->
    <!-- Core modules (no dependencies) -->
    <script src="js/constants.js"></script>
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    
    <!-- UI modules (depend on core) -->
    <script src="js/theme.js"></script>
    <script src="js/wizard.js"></script>
    <script src="js/form.js"></script>
    <script src="js/validation.js"></script>
    
    <!-- Feature modules (depend on core + UI) -->
    <script src="js/api.js"></script>
    <script src="js/recommendation.js"></script>
    <script src="js/tabs.js"></script>
    <script src="js/games-library.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/calendar.js"></script>
    
    <!-- Main init (depends on all above) -->
    <script src="js/main.js"></script>

</body>
</html>
