<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lutem - AI-Powered Gaming Recommendations</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <!-- External CSS Files -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/themes.css">
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/layout.css">
    <link rel="stylesheet" href="css/nav-controls.css">
    <link rel="stylesheet" href="css/pages/calendar.css">
    
    <!-- CSS moved to external files: variables.css, themes.css, base.css, components.css, layout.css -->
    
    <!-- FullCalendar JS (v6 has CSS bundled in JS) -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js'></script>
    
    <!-- Demo Mode Scripts (for GitHub Pages) -->
    <script src="games-data.js"></script>
    <script src="demo-mode.js"></script>
</head>
<body>
    <!-- Auth Header (fixed at top) -->
    <header class="auth-header">
        <div class="auth-header-content">
            <div class="auth-header-spacer"></div>
            
            <!-- Sign In Button (shown when logged out) -->
            <button id="headerSignInBtn" onclick="openAuthModal('signin')">
                <span>ğŸ”</span>
                <span>Sign In</span>
            </button>
            
            <!-- User Section (shown when logged in) -->
            <div id="userHeaderSection">
                <!-- Pending Sessions Badge -->
                <div id="pendingSessionsBadgeContainer" onclick="showPendingSessionsModal()" title="Pending session feedback">
                    <span id="pendingSessionsBadge" class="pending-badge" style="display: none;">0</span>
                    <span class="pending-badge-icon">ğŸ“‹</span>
                </div>
                <span id="userHeaderName">Player</span>
                <div id="userHeaderAvatar" onclick="toggleUserDropdown()">ğŸ‘¤</div>
                <div class="user-dropdown" id="userDropdown">
                    <div class="user-dropdown-item" onclick="openAuthModal('signin'); toggleUserDropdown();">
                        <span>ğŸ‘¤</span> Profile
                    </div>
                    <div class="user-dropdown-divider"></div>
                    <div class="user-dropdown-item" onclick="signOut(); toggleUserDropdown();">
                        <span>ğŸšª</span> Sign Out
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Tab Navigation (Bottom Bar) -->
    <nav class="tab-navigation">
        <div class="tab-container">
            <!-- Logo moved to page header -->
            <div class="tabs">
                <button class="tab-button active" data-page="home">
                    <span class="tab-icon">ğŸ </span>
                    <span>Home</span>
                </button>
                <button class="tab-button" data-page="calendar">
                    <span class="tab-icon">ğŸ“…</span>
                    <span>Calendar</span>
                </button>
                <button class="tab-button" data-page="games">
                    <span class="tab-icon">ğŸ®</span>
                    <span>Games</span>
                </button>
                <button class="tab-button" data-page="profile">
                    <span class="tab-icon">ğŸ‘¤</span>
                    <span>Profile</span>
                </button>
            </div>
            
            <!-- Nav Controls (Wizard & Theme) -->
            <div class="nav-controls">
                <button class="nav-control-btn" id="navWizardBtn" onclick="openGuidedModal()" title="Quick Start Wizard">
                    <span class="nav-control-icon">ğŸ§™</span>
                    <span class="nav-control-label">Wizard</span>
                </button>
                <button class="nav-control-btn" id="navThemeBtn" onclick="toggleNavPaletteMenu()" title="Change Theme">
                    <span class="nav-control-icon" id="navPaletteIcon">ğŸ¨</span>
                    <span class="nav-control-label">Theme</span>
                </button>
                
                <!-- Inline Theme Menu (appears beside theme button) -->
                <div class="nav-palette-menu" id="navPaletteMenu">
                    <div class="palette-selector-header">ğŸ¨ Theme</div>
                    <div class="mode-toggle-container">
                        <button class="mode-toggle-btn active" data-mode="light" onclick="setNavMode('light')">
                            <span>â˜€ï¸</span> Light
                        </button>
                        <button class="mode-toggle-btn" data-mode="dark" onclick="setNavMode('dark')">
                            <span>ğŸŒ™</span> Dark
                        </button>
                    </div>
                    <div class="palette-colors">
                        <div class="palette-color-option active" data-palette="cafe" onclick="setNavPalette('cafe')">
                            <span class="palette-color-icon">â˜•</span>
                            <span class="palette-color-label">Warm CafÃ©</span>
                        </div>
                        <div class="palette-color-option" data-palette="lavender" onclick="setNavPalette('lavender')">
                            <span class="palette-color-icon">ğŸ’œ</span>
                            <span class="palette-color-label">Soft Lavender</span>
                        </div>
                        <div class="palette-color-option" data-palette="earth" onclick="setNavPalette('earth')">
                            <span class="palette-color-icon">ğŸŒ¿</span>
                            <span class="palette-color-label">Natural Earth</span>
                        </div>
                        <div class="palette-color-option" data-palette="ocean" onclick="setNavPalette('ocean')">
                            <span class="palette-color-icon">ğŸŒŠ</span>
                            <span class="palette-color-label">Ocean Breeze</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Sidebar Auth Section (visible on desktop only) -->
            <div class="sidebar-auth">
                <!-- Sign In Button (shown when logged out) -->
                <button class="sidebar-auth-btn" id="sidebarSignInBtn" onclick="openAuthModal('signin')">
                    <span class="tab-icon">ğŸ”</span>
                    <span>Sign In</span>
                </button>
                
                <!-- User Section (shown when logged in) -->
                <div class="sidebar-user" id="sidebarUserSection">
                    <div class="sidebar-avatar" onclick="toggleSidebarUserDropdown()">ğŸ‘¤</div>
                    <span class="sidebar-username" id="sidebarUserName">Player</span>
                    <div class="sidebar-user-dropdown" id="sidebarUserDropdown">
                        <div class="user-dropdown-item" onclick="openAuthModal('signin'); toggleSidebarUserDropdown();">
                            <span>ğŸ‘¤</span> Profile
                        </div>
                        <div class="user-dropdown-divider"></div>
                        <div class="user-dropdown-item" onclick="signOut(); toggleSidebarUserDropdown();">
                            <span>ğŸšª</span> Sign Out
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="nav-credits">
                <span>Jan Wilhelm</span>
                <a href="https://github.com/jantobiaswilhelm/LutemPrototype" target="_blank" rel="noopener" title="View on GitHub">
                    <svg height="18" width="18" viewBox="0 0 16 16" fill="currentColor">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                </a>
            </div>
        </div>
    </nav>

    <!-- HOME PAGE (existing content) -->
    <div id="home-page" class="page-content active">

    <!-- Guided Setup Modal -->
    <div class="guided-modal-overlay" id="guidedModalOverlay">
        <div class="guided-modal">
            <div class="guided-modal-header">
                <img src="lutem-logo.png" alt="Lutem" class="logo-small">
                <p id="modalHeaderText">Let's find your perfect game!</p>
            </div>

            <div class="guided-modal-body">
                <!-- Welcome Screen -->
                <div class="guided-question active" id="welcomeScreen">
                    <div class="welcome-choices">
                        <div class="choice-card" onclick="startQuickSetup()">
                            <div class="choice-card-icon">ğŸš€</div>
                            <div class="choice-card-title">Quick Start</div>
                            <div class="choice-card-desc">Answer 4 simple questions</div>
                            <div style="font-size: 0.85em; color: var(--text-light); font-weight: 600;">~40 seconds</div>
                        </div>

                        <div class="choice-card" onclick="useFullForm()">
                            <div class="choice-card-icon">âš™ï¸</div>
                            <div class="choice-card-title">Custom Setup</div>
                            <div class="choice-card-desc">Full control over all options</div>
                            <div style="font-size: 0.85em; color: var(--text-light); font-weight: 600;">~2 minutes</div>
                        </div>
                    </div>
                </div>

                <!-- Question 1: Energy Level -->
                <div class="guided-question" id="question1">
                    <div class="progress-dots">
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>

                    <h3 class="question-title">How are you feeling right now?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Choose what matches your current energy</p>

                    <div class="big-options">
                        <div class="big-option" data-value="LOW" onclick="selectBigOption(this, 'guidedEnergy')">
                            <div class="big-option-icon">ğŸ”‹</div>
                            <div class="big-option-label">Low Energy</div>
                        </div>
                        <div class="big-option" data-value="MEDIUM" onclick="selectBigOption(this, 'guidedEnergy')">
                            <div class="big-option-icon">ğŸ”‹ğŸ”‹</div>
                            <div class="big-option-label">Medium Energy</div>
                        </div>
                        <div class="big-option" data-value="HIGH" onclick="selectBigOption(this, 'guidedEnergy')">
                            <div class="big-option-icon">ğŸ”‹ğŸ”‹ğŸ”‹</div>
                            <div class="big-option-label">High Energy</div>
                        </div>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToWelcome()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" id="q1NextBtn" disabled onclick="goToQuestion2()">Next â†’</button>
                    </div>
                </div>

                <!-- Question 2: Time -->
                <div class="guided-question" id="question2">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>

                    <h3 class="question-title">How much time do you have?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Drag the slider to set your available time</p>

                    <div class="big-time-display" id="guidedTimeDisplay">30 minutes</div>
                    <input type="range" id="guidedTimeSlider" min="0" max="7" value="2" step="1" class="big-slider">
                    <div style="display: flex; justify-content: space-between; font-size: 0.9em; color: var(--text-secondary);">
                        <span>5 min</span>
                        <span>3+ hrs</span>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToQuestion1()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" onclick="goToQuestion3()">Next â†’</button>
                    </div>
                </div>

                <!-- Question 3: Mood/Goals -->
                <div class="guided-question" id="question3">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                    </div>

                    <h3 class="question-title">What do you want to feel?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Select one or more that resonate with you</p>

                    <div class="mood-chips-grid">
                        <div class="mood-chip-big" data-value="UNWIND" onclick="toggleMoodChip(this)">ğŸ˜Œ Unwind and relax</div>
                        <div class="mood-chip-big" data-value="PROGRESS_ORIENTED" onclick="toggleMoodChip(this)">ğŸ† Progress Oriented</div>
                        <div class="mood-chip-big" data-value="LOCKING_IN" onclick="toggleMoodChip(this)">ğŸ¯ Locking in</div>
                        <div class="mood-chip-big" data-value="ADVENTURE_TIME" onclick="toggleMoodChip(this)">ğŸ—ºï¸ Adventure Time</div>
                        <div class="mood-chip-big" data-value="CHALLENGE" onclick="toggleMoodChip(this)">âš¡ Challenge Myself</div>
                        <div class="mood-chip-big" data-value="RECHARGE" onclick="toggleMoodChip(this)">ğŸ”‹ Recharge Energy</div>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToQuestion2()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" id="q3NextBtn" disabled onclick="goToQuestion4()">Next â†’</button>
                    </div>
                </div>

                <!-- Question 4: Interruptibility -->
                <div class="guided-question" id="question4">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                    </div>

                    <h3 class="question-title">Can you pause anytime?</h3>
                    <p style="text-align: center; color: var(--text-secondary); margin-bottom: 30px; font-size: 1.05em;">Do you need the flexibility to stop whenever needed?</p>

                    <div class="big-options">
                        <div class="big-option" data-value="HIGH" onclick="selectBigOption(this, 'guidedInterruptibility')">
                            <div class="big-option-icon">â¸ï¸</div>
                            <div class="big-option-label">Yes, Anytime</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">Total flexibility</div>
                        </div>
                        <div class="big-option" data-value="MEDIUM" onclick="selectBigOption(this, 'guidedInterruptibility')">
                            <div class="big-option-icon">ğŸ’¾</div>
                            <div class="big-option-label">Some Pauses</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">Are fine</div>
                        </div>
                        <div class="big-option" data-value="LOW" onclick="selectBigOption(this, 'guidedInterruptibility')">
                            <div class="big-option-icon">ğŸ”’</div>
                            <div class="big-option-label">No, I'm Locked In</div>
                            <div style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">Full commitment</div>
                        </div>
                    </div>

                    <div class="modal-nav-buttons">
                        <button class="modal-btn modal-btn-secondary" onclick="goToQuestion3()">â† Back</button>
                        <button class="modal-btn modal-btn-primary" id="q4NextBtn" disabled onclick="submitGuidedSetup()">Get Recommendation ğŸ®</button>
                    </div>
                </div>
            </div>

            <div class="guided-modal-footer">
                <a href="#" onclick="useFullForm(); return false;">Or use the full form for more control â†’</a>
            </div>
        </div>
    </div>

    <!-- Touch Grass Modal -->
    <div class="modal-overlay" id="touchGrassModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸŒ±</div>
            <h2>Time to Touch Grass?</h2>
            <p>3+ hours of gaming is a marathon session!</p>
            <p style="margin-top: 15px; font-weight: 600;">Before you dive in, consider:</p>
            <ul style="text-align: left; margin-top: 10px; padding-left: 20px;">
                <li style="margin: 10px 0; color: var(--text-secondary);">Have you moved your body today?</li>
                <li style="margin: 10px 0; color: var(--text-secondary);">Have you had water recently?</li>
                <li style="margin: 10px 0; color: var(--text-secondary);">Is your space comfortable for a long session?</li>
            </ul>
            <div class="modal-buttons">
                <button class="modal-btn modal-btn-secondary" onclick="closeTouchGrassModal(false)">I'll Choose Less Time</button>
                <button class="modal-btn modal-btn-primary" onclick="closeTouchGrassModal(true)">I'm Ready! ğŸ®</button>
            </div>
        </div>
    </div>

    <!-- Page Header with Logo -->
    <div class="page-header">
        <div class="page-header-logo">LUTEM</div>
        <div class="page-header-tagline">Find your perfect game for right now</div>
    </div>

    <!-- Weekly Summary Section (Phase E) -->
    <div class="container">
        <div id="weeklySummarySection">
            <!-- Populated by weekly-summary.js -->
        </div>
    </div>

    <div class="container" id="mainContainer">

        <!-- NEW: Single-column Home Wizard -->
        <div class="home-wizard">
            
            <!-- NEW: Grid wrapper for desktop 2x2 layout -->
            <div class="wizard-inputs-grid">
            
            <!-- Section 1: Energy Level (Top-Left on desktop) -->
            <div class="wizard-section" data-section="energy">
                <div class="wizard-question">
                    âš¡ How's your energy right now?
                </div>
                <div class="energy-grid" id="energyLevel">
                    <div class="energy-card" data-value="LOW">
                        <div class="energy-card-battery">
                            <div class="battery-fill" style="height: 33%"></div>
                        </div>
                        <div class="energy-card-label">Low Energy</div>
                    </div>
                    <div class="energy-card" data-value="MEDIUM">
                        <div class="energy-card-battery">
                            <div class="battery-fill" style="height: 66%"></div>
                        </div>
                        <div class="energy-card-label">Medium</div>
                    </div>
                    <div class="energy-card" data-value="HIGH">
                        <div class="energy-card-battery">
                            <div class="battery-fill" style="height: 100%"></div>
                        </div>
                        <div class="energy-card-label">High Energy</div>
                    </div>
                </div>
            </div>

            <!-- Section 2: Time Available (Top-Right on desktop) -->
            <div class="wizard-section" data-section="time">
                <div class="wizard-question">
                    â±ï¸ How much time do you have?
                </div>
                <div class="time-section">
                    <div class="time-value-display" id="timeDisplay">30 min</div>
                    <input type="range" id="timeSlider" min="0" max="7" value="2" step="1" class="discrete-slider">
                    <div class="time-labels">
                        <span>5min</span>
                        <span>15min</span>
                        <span>30min</span>
                        <span>45min</span>
                        <span>1hr</span>
                        <span>2hr</span>
                        <span>3hr</span>
                        <span>3hr+</span>
                    </div>
                </div>
            </div>

            <!-- Section 3: Mood/Emotional Goals (Bottom-Left on desktop) -->
            <div class="wizard-section" data-section="mood">
                <div class="wizard-question">
                    ğŸ˜Š What do you want to feel?
                    <div class="wizard-question-sub">(select all that apply)</div>
                </div>
                <div class="mood-grid" id="emotionalGoals">
                    <div class="mood-chip" data-value="UNWIND">ğŸ˜Œ Unwind</div>
                    <div class="mood-chip" data-value="PROGRESS_ORIENTED">ğŸ† Progress</div>
                    <div class="mood-chip" data-value="LOCKING_IN">ğŸ¯ Focus</div>
                    <div class="mood-chip" data-value="ADVENTURE_TIME">ğŸ—ºï¸ Adventure</div>
                    <div class="mood-chip" data-value="CHALLENGE">âš¡ Challenge</div>
                    <div class="mood-chip" data-value="RECHARGE">ğŸ”‹ Recharge</div>
                </div>
            </div>

            <!-- Section 4: Interruptibility (Bottom-Right on desktop) -->
            <div class="wizard-section" data-section="interrupt">
                <div class="wizard-question">
                    â¸ï¸ Can you pause anytime?
                </div>
                <div class="interrupt-grid" id="interruptibility">
                    <div class="interrupt-card" data-value="HIGH">
                        <div class="interrupt-card-icon">â¸ï¸</div>
                        <div class="interrupt-card-label">Yes</div>
                        <div class="interrupt-card-sub">Flexible</div>
                    </div>
                    <div class="interrupt-card" data-value="MEDIUM">
                        <div class="interrupt-card-icon">ğŸ’¾</div>
                        <div class="interrupt-card-label">Some</div>
                        <div class="interrupt-card-sub">Pauses OK</div>
                    </div>
                    <div class="interrupt-card" data-value="LOW">
                        <div class="interrupt-card-icon">ğŸ”’</div>
                        <div class="interrupt-card-label">No</div>
                        <div class="interrupt-card-sub">Locked in</div>
                    </div>
                </div>
            </div>

            </div> <!-- End wizard-inputs-grid -->

            <!-- Collapsed Summary Bar (shown after recommendation) -->
            <div class="wizard-summary-bar" id="wizardSummaryBar" style="display: none;">
                <div class="summary-bar-content">
                    <div class="summary-items">
                        <span class="summary-item" id="summaryEnergy">
                            <span class="summary-icon">âš¡</span>
                            <span class="summary-value">Medium</span>
                        </span>
                        <span class="summary-divider">|</span>
                        <span class="summary-item" id="summaryTime">
                            <span class="summary-icon">â±ï¸</span>
                            <span class="summary-value">30 min</span>
                        </span>
                        <span class="summary-divider">|</span>
                        <span class="summary-item" id="summaryMood">
                            <span class="summary-icon">ğŸ˜Š</span>
                            <span class="summary-value">Unwind</span>
                        </span>
                        <span class="summary-divider">|</span>
                        <span class="summary-item" id="summaryInterrupt">
                            <span class="summary-icon">â¸ï¸</span>
                            <span class="summary-value">Flexible</span>
                        </span>
                    </div>
                    <button class="summary-edit-btn" id="summaryEditBtn" onclick="expandWizardForm()">
                        âœï¸ Edit
                    </button>
                </div>
            </div>

            <!-- Submit Button Row (full width, centered) -->
            <div class="wizard-submit-row">
                <button class="wizard-submit" id="recommendBtn">
                    ğŸ® Get Recommendation
                </button>
            </div>

            <!-- Advanced Options Toggles -->
            <div class="advanced-section">
                <!-- Genre Preferences Toggle -->
                <div class="advanced-toggle" id="genreToggle">
                    <span class="advanced-toggle-text">
                        <span>ğŸ¯</span>
                        <span>Genre Preferences</span>
                    </span>
                    <span class="advanced-toggle-icon">â–¼</span>
                </div>

                <!-- Advanced Options Toggle -->
                <div class="advanced-toggle" id="advancedToggle">
                    <span class="advanced-toggle-text">
                        <span>âš™ï¸</span>
                        <span>More Options</span>
                    </span>
                    <span class="advanced-toggle-icon">â–¼</span>
                </div>
            </div>

            <!-- Genre Preferences Content (hidden by default) -->
            <!-- NEW: Grid wrapper for desktop side-by-side advanced sections -->
            <div class="advanced-sections-grid">
            
            <!-- Optional section header - visible on desktop only -->
            <div class="optional-section-header">
                <span class="optional-label">âœ¨ Optional Preferences</span>
                <span class="optional-hint">Fine-tune your recommendations</span>
            </div>
            <div class="advanced-content" id="genreContent">
                <div class="wizard-section" style="margin-top: 16px;">
                    <div class="wizard-question" style="font-size: 1em;">
                        Select genres you enjoy
                        <div class="wizard-question-sub">(ranks them higher in results)</div>
                    </div>
                    <div class="chip-container" id="genrePreferences">
                        <div class="chip" data-genre="RPG">ğŸ—¡ï¸ RPG</div>
                        <div class="chip" data-genre="Action">âš”ï¸ Action</div>
                        <div class="chip" data-genre="Strategy">â™Ÿï¸ Strategy</div>
                        <div class="chip" data-genre="Puzzle">ğŸ§© Puzzle</div>
                        <div class="chip" data-genre="Adventure">ğŸ—ºï¸ Adventure</div>
                        <div class="chip" data-genre="Simulation">ğŸ® Simulation</div>
                        <div class="chip" data-genre="Sports">âš½ Sports</div>
                        <div class="chip" data-genre="Racing">ğŸï¸ Racing</div>
                        <div class="chip" data-genre="Roguelike">ğŸ² Roguelike</div>
                        <div class="chip" data-genre="Card Game">ğŸƒ Card Game</div>
                        <div class="chip" data-genre="Battle Royale">ğŸ¯ Battle Royale</div>
                        <div class="chip" data-genre="Tactical FPS">ğŸ”« Tactical FPS</div>
                        <div class="chip" data-genre="Horror">ğŸ‘» Horror</div>
                        <div class="chip" data-genre="Platformer">ğŸ¦˜ Platformer</div>
                        <div class="chip" data-genre="Sandbox">ğŸ—ï¸ Sandbox</div>
                        <div class="chip" data-genre="Party Game">ğŸ‰ Party Game</div>
                        <div class="chip" data-genre="Board Game">ğŸ² Board Game</div>
                        <div class="chip" data-genre="Management">ğŸ“Š Management</div>
                        <div class="chip" data-genre="Life Sim">ğŸ¡ Life Sim</div>
                        <div class="chip" data-genre="Social Deduction">ğŸ•µï¸ Social Deduction</div>
                        <div class="chip" data-genre="Survival">â›º Survival</div>
                        <div class="chip" data-genre="Co-op Adventure">ğŸ¤ Co-op Adventure</div>
                        <div class="chip" data-genre="Arcade">ğŸ‘¾ Arcade</div>
                        <div class="chip" data-genre="Farming Sim">ğŸšœ Farming Sim</div>
                    </div>
                </div>
            </div>

            <!-- Advanced Options Content (hidden by default) -->
            <div class="advanced-content" id="advancedContent">
                <div class="wizard-section" style="margin-top: 16px;">
                    <div class="wizard-question" style="font-size: 1em;">
                        Time of day
                    </div>
                    <div class="radio-group" id="timeOfDay">
                        <div class="radio-option" data-value="MORNING">Morning</div>
                        <div class="radio-option" data-value="MIDDAY">Midday</div>
                        <div class="radio-option" data-value="AFTERNOON">Afternoon</div>
                        <div class="radio-option" data-value="EVENING">Evening</div>
                        <div class="radio-option" data-value="LATE_NIGHT">Late Night</div>
                    </div>
                </div>
                <div class="wizard-section" style="margin-top: 16px;">
                    <div class="wizard-question" style="font-size: 1em;">
                        How do you want to play?
                    </div>
                    <div class="radio-group" id="socialPreference">
                        <div class="radio-option" data-value="SOLO">Solo</div>
                        <div class="radio-option" data-value="COOP">Co-op</div>
                        <div class="radio-option" data-value="COMPETITIVE">Competitive</div>
                    </div>
                </div>
            </div>
            </div> <!-- End advanced-sections-grid -->

            <!-- Results Container (shown after recommendation) -->
            <div class="results-container" id="resultsPanel">
                <div class="placeholder">
                    <div class="icon">ğŸ®</div>
                    <p>Select your preferences and click "Get Recommendation"</p>
                    <p style="margin-top: 10px; font-size: 0.9em;">We'll find the perfect game for your mood and time!</p>
                </div>
            </div>

        </div> <!-- End home-wizard -->
    </div>

    </div> <!-- End of home-page -->

    <!-- CALENDAR PAGE -->
    <div id="calendar-page" class="page-content">
        <!-- Locked Overlay (shown when not authenticated) -->
        <div id="calendarLockedOverlay" class="locked-page-overlay" style="display: none;">
            <span class="lock-icon">ğŸ”’</span>
            <h2>Calendar Locked</h2>
            <p>Schedule your gaming sessions and track your play time. Sign in to unlock this feature.</p>
            <button class="unlock-btn" onclick="openAuthModal('signin')">Sign in to unlock</button>
        </div>
        <div class="container">
            <header class="calendar-header">
                <div class="calendar-header-content">
                    <div class="calendar-header-text">
                        <h1>My Calendar</h1>
                        <p>Plan your gaming sessions and tasks</p>
                    </div>
                    <div class="calendar-header-actions">
                        <button class="calendar-add-btn gaming-btn" 
                                onclick="openAddEventModal(null, null, 'gaming')"
                                title="Schedule a gaming session">
                            <span>ğŸ®</span>
                            <span>Gaming Session</span>
                        </button>
                        <button class="calendar-add-btn task-btn" 
                                onclick="openAddEventModal(null, null, 'task')"
                                title="Create a task or event">
                            <span>ğŸ“‹</span>
                            <span>New Task</span>
                        </button>
                        <button class="calendar-add-btn import-btn" 
                                onclick="openImportModal()"
                                title="Import calendar from ICS file">
                            <span>ğŸ“¥</span>
                            <span>Import</span>
                        </button>
                    </div>
                </div>
            </header>
            
            <!-- Calendar Container -->
            <div class="calendar-card">
                <div id="calendar"></div>
            </div>
            
            <!-- Calendar Legend -->
            <div class="calendar-legend">
                <div class="calendar-legend-item">
                    <span class="calendar-legend-color gaming"></span>
                    <span class="calendar-legend-text">ğŸ® Gaming (Calendar)</span>
                </div>
                <div class="calendar-legend-item">
                    <span class="calendar-legend-color session-pending"></span>
                    <span class="calendar-legend-text">â³ Scheduled Session</span>
                </div>
                <div class="calendar-legend-item">
                    <span class="calendar-legend-color session-completed"></span>
                    <span class="calendar-legend-text">âœ… Completed</span>
                </div>
                <div class="calendar-legend-item">
                    <span class="calendar-legend-color session-skipped"></span>
                    <span class="calendar-legend-text">â­ï¸ Skipped</span>
                </div>
                <div class="calendar-legend-item">
                    <span class="calendar-legend-color task"></span>
                    <span class="calendar-legend-text">ğŸ“‹ Task/Event</span>
                </div>
            </div>
        </div>
    </div>

    <!-- GAMES PAGE -->
    <div id="games-page" class="page-content">
        <div class="container">
            <header style="margin-top: 40px; margin-bottom: 30px;">
                <h1 style="text-align: center; color: var(--text-primary); font-size: 2.5em;">Game Library</h1>
                <p style="text-align: center; color: var(--text-secondary); margin-top: 10px;">Browse all available games</p>
            </header>
            
            <!-- Filter Section -->
            <div style="background: var(--surface); border-radius: 16px; padding: 25px; margin-bottom: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
                    
                    <!-- Search -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ” Search
                        </label>
                        <input type="text" id="gameSearch" placeholder="Search games..." 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                               background: var(--background); color: var(--text-primary); font-size: 0.95em; transition: all 0.3s;">
                    </div>
                    
                    <!-- Genre Filter -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ¯ Genre
                        </label>
                        <select id="genreFilter" 
                                style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                                background: var(--background); color: var(--text-primary); font-size: 0.95em; cursor: pointer;">
                            <option value="">All Genres</option>
                        </select>
                    </div>
                    
                    <!-- Mood Filter -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ˜Š Mood
                        </label>
                        <select id="moodFilter" 
                                style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                                background: var(--background); color: var(--text-primary); font-size: 0.95em; cursor: pointer;">
                            <option value="">All Moods</option>
                            <option value="UNWIND">ğŸ˜Œ Unwind</option>
                            <option value="RECHARGE">âš¡ Recharge</option>
                            <option value="ENGAGE">ğŸ¯ Engage</option>
                            <option value="CHALLENGE">ğŸ’ª Challenge</option>
                            <option value="EXPLORE">ğŸ—ºï¸ Explore</option>
                            <option value="ACHIEVE">ğŸ† Achieve</option>
                            <option value="ADVENTURE_TIME">ğŸ—ºï¸ Adventure</option>
                            <option value="PROGRESS_ORIENTED">ğŸ“ˆ Progress</option>
                            <option value="LOCKING_IN">ğŸ”’ Focus</option>
                        </select>
                    </div>
                    
                    <!-- Time Filter -->
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            â±ï¸ Time Available
                        </label>
                        <select id="timeFilter" 
                                style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; 
                                background: var(--background); color: var(--text-primary); font-size: 0.95em; cursor: pointer;">
                            <option value="">Any Duration</option>
                            <option value="0-30">Quick (0-30 min)</option>
                            <option value="30-60">Medium (30-60 min)</option>
                            <option value="60-999">Long (60+ min)</option>
                        </select>
                    </div>
                </div>
                
                <!-- Clear Filters Button -->
                <div style="margin-top: 20px; text-align: center;">
                    <button id="clearFilters" 
                            style="padding: 10px 24px; background: var(--background); color: var(--text-secondary); 
                            border: 2px solid var(--border); border-radius: 10px; cursor: pointer; font-size: 0.95em; 
                            transition: all 0.3s; font-weight: 500;">
                        Clear All Filters
                    </button>
                </div>
            </div>
            
            <!-- Results Count -->
            <div style="margin-bottom: 20px; color: var(--text-secondary); text-align: center; font-size: 0.95em;">
                Showing <span id="gamesCount" style="color: var(--primary); font-weight: 600;">0</span> games
            </div>
            
            <!-- Games Grid -->
            <div id="gamesGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; padding-bottom: 40px;">
                <!-- Games will be inserted here -->
            </div>
            
            <!-- Loading State -->
            <div id="gamesLoading" style="text-align: center; padding: 60px 20px; display: none;">
                <div class="spinner" style="margin: 0 auto 20px;"></div>
                <p style="color: var(--text-secondary);">Loading games...</p>
            </div>
            
            <!-- Empty State -->
            <div id="gamesEmpty" style="text-align: center; padding: 60px 20px; display: none;">
                <div style="font-size: 3em; margin-bottom: 20px;">ğŸ®</div>
                <h3 style="color: var(--text-primary); margin-bottom: 15px;">No games found</h3>
                <p style="color: var(--text-secondary); max-width: 500px; margin: 0 auto;">
                    Try adjusting your filters or search terms
                </p>
            </div>
        </div>
    </div>

    <!-- PROFILE PAGE -->
    <div id="profile-page" class="page-content">
        <!-- Locked Overlay (shown when not authenticated) -->
        <div id="profileLockedOverlay" class="locked-page-overlay" style="display: none;">
            <span class="lock-icon">ğŸ”’</span>
            <h2>Profile Locked</h2>
            <p>Customize your gaming preferences and view your stats. Sign in to unlock this feature.</p>
            <button class="unlock-btn" onclick="openAuthModal('signin')">Sign in to unlock</button>
        </div>
        <div class="container">
            <header style="margin-top: 40px;">
                <h1 style="text-align: center; color: var(--text-primary); font-size: 2.5em;">Your Profile</h1>
                <p style="text-align: center; color: var(--text-secondary); margin-top: 10px;">Customize your gaming experience</p>
            </header>
            
            <div style="max-width: 900px; margin: 40px auto; padding: 0 20px;">
                <!-- User Info Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ‘¤</span>
                        User Information
                    </h2>
                    <div class="profile-card">
                        <div class="user-avatar-container">
                            <div class="user-avatar">
                                <span style="font-size: 4em;">ğŸ‘¤</span>
                            </div>
                            <button class="btn-secondary" style="margin-top: 15px;">Change Avatar</button>
                        </div>
                        <div class="user-info-fields">
                            <div class="form-group">
                                <label>Display Name</label>
                                <input type="text" id="displayName" placeholder="Enter your name" value="Player">
                            </div>
                            <div class="form-group">
                                <label>Gaming Since</label>
                                <input type="text" id="gamingSince" placeholder="Year" value="2015">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Linked Game Libraries Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ®</span>
                        Linked Game Libraries
                    </h2>
                    <div class="profile-card">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            Connect your gaming platforms to get personalized recommendations
                        </p>
                        <div class="library-connections">
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">ğŸŸ¦</span>
                                    <div>
                                        <div class="library-name">Steam</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">â¬›</span>
                                    <div>
                                        <div class="library-name">Epic Games</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">ğŸŸ©</span>
                                    <div>
                                        <div class="library-name">Xbox</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                            <div class="library-item">
                                <div class="library-info">
                                    <span class="library-icon">ğŸŸ¦</span>
                                    <div>
                                        <div class="library-name">PlayStation</div>
                                        <div class="library-status">Not Connected</div>
                                    </div>
                                </div>
                                <button class="btn-secondary">Connect</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gaming Preferences Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">âš™ï¸</span>
                        Gaming Preferences
                    </h2>
                    <div class="profile-card">
                        <div class="form-group">
                            <label>Preferred Genres</label>
                            <div class="genre-tags">
                                <button class="genre-tag">Action</button>
                                <button class="genre-tag active">RPG</button>
                                <button class="genre-tag">Strategy</button>
                                <button class="genre-tag active">Puzzle</button>
                                <button class="genre-tag">Sports</button>
                                <button class="genre-tag">Simulation</button>
                                <button class="genre-tag">Adventure</button>
                                <button class="genre-tag">Shooter</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Typical Session Length</label>
                            <select id="sessionLength">
                                <option value="5-15">Quick (5-15 min)</option>
                                <option value="15-30" selected>Short (15-30 min)</option>
                                <option value="30-60">Medium (30-60 min)</option>
                                <option value="60+">Long (60+ min)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Engagement Level</label>
                            <select id="engagementLevel">
                                <option value="casual">Casual - Low intensity</option>
                                <option value="moderate" selected>Moderate - Balanced</option>
                                <option value="intense">Intense - High focus</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Gaming Schedule Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ“…</span>
                        Gaming Schedule
                    </h2>
                    <div class="profile-card">
                        <div class="form-group">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" id="calendarSync">
                                <span>Sync with my calendar (Coming Soon)</span>
                            </label>
                            <p style="color: var(--text-secondary); font-size: 0.9em; margin-top: 8px; margin-left: 28px;">
                                Connect Google Calendar, Outlook, or Apple Calendar to get personalized game suggestions based on your free time
                            </p>
                        </div>

                        <div class="form-group">
                            <label>Preferred Gaming Times</label>
                            <div class="time-preference-grid">
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="morning">
                                    <span>ğŸŒ… Morning (6am-12pm)</span>
                                </label>
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="afternoon" checked>
                                    <span>â˜€ï¸ Afternoon (12pm-6pm)</span>
                                </label>
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="evening" checked>
                                    <span>ğŸŒ™ Evening (6pm-12am)</span>
                                </label>
                                <label class="time-checkbox">
                                    <input type="checkbox" name="gaming-time" value="night">
                                    <span>ğŸŒƒ Late Night (12am-6am)</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Gaming Priorities Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ¯</span>
                        Gaming Priorities
                    </h2>
                    <div class="profile-card">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            What do you value most in your gaming sessions?
                        </p>
                        <div class="priorities-grid">
                            <label class="priority-card">
                                <input type="radio" name="priority" value="relaxation" checked>
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ§˜</div>
                                    <div class="priority-title">Relaxation</div>
                                    <div class="priority-desc">Unwind and destress</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="challenge">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ†</div>
                                    <div class="priority-title">Challenge</div>
                                    <div class="priority-desc">Test your skills</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="social">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ‘¥</div>
                                    <div class="priority-title">Social</div>
                                    <div class="priority-desc">Play with others</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="story">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ“–</div>
                                    <div class="priority-title">Story</div>
                                    <div class="priority-desc">Immersive narratives</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="competition">
                                <div class="priority-content">
                                    <div class="priority-icon">âš”ï¸</div>
                                    <div class="priority-title">Competition</div>
                                    <div class="priority-desc">Ranked matches</div>
                                </div>
                            </label>
                            <label class="priority-card">
                                <input type="radio" name="priority" value="exploration">
                                <div class="priority-content">
                                    <div class="priority-icon">ğŸ—ºï¸</div>
                                    <div class="priority-title">Exploration</div>
                                    <div class="priority-desc">Discover new worlds</div>
                                </div>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Emotional Goals Section -->
                <div class="profile-section">
                    <h2 class="profile-section-title">
                        <span class="profile-icon">ğŸ’­</span>
                        Emotional Goals
                    </h2>
                    <div class="profile-card">
                        <p style="color: var(--text-secondary); margin-bottom: 20px;">
                            Select the moods and feelings you want from your gaming sessions
                        </p>
                        <div class="emotional-goals-grid">
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="unwind" checked>
                                <span class="goal-badge">ğŸŒŠ Unwind</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="recharge" checked>
                                <span class="goal-badge">âš¡ Recharge</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="engage">
                                <span class="goal-badge">ğŸ¯ Engage</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="challenge">
                                <span class="goal-badge">ğŸ”¥ Challenge</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="explore">
                                <span class="goal-badge">ğŸ—ºï¸ Explore</span>
                            </label>
                            <label class="emotional-goal">
                                <input type="checkbox" name="emotional-goal" value="achieve">
                                <span class="goal-badge">ğŸ† Achieve</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Save Button -->
                <div style="text-align: center; margin: 40px 0;">
                    <button class="btn-primary" onclick="saveProfile()" style="padding: 15px 50px; font-size: 1.1em;">
                        ğŸ’¾ Save Profile
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- EVENT DETAILS MODAL -->
    <div id="eventDetailsModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: var(--surface); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 id="eventDetailsTitle" style="color: var(--text-primary); font-size: 1.8em; margin: 0;">Event Details</h2>
                <button onclick="closeEventDetailsModal()" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: var(--text-secondary); padding: 5px 10px; border-radius: 8px; transition: all 0.3s;" 
                        onmouseover="this.style.background='var(--bg-main)'"
                        onmouseout="this.style.background='none'">âœ•</button>
            </div>
            
            <div style="background: var(--bg-main); padding: 15px; border-radius: 12px; margin-bottom: 15px;">
                <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 5px;">â° Time</p>
                <p id="eventDetailsTime" style="color: var(--text-primary); font-weight: 600; margin: 0;"></p>
            </div>
            
            <div style="background: var(--bg-main); padding: 15px; border-radius: 12px; margin-bottom: 25px;">
                <p style="color: var(--text-secondary); font-size: 0.9em; margin-bottom: 5px;">ğŸ“ Description</p>
                <p id="eventDetailsDescription" style="color: var(--text-primary); margin: 0;"></p>
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button onclick="deleteCurrentEvent()" style="background: #f44336; color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                        onmouseover="this.style.background='#d32f2f'; this.style.transform='translateY(-2px)'"
                        onmouseout="this.style.background='#f44336'; this.style.transform='translateY(0)'">
                    ğŸ—‘ï¸ Delete Event
                </button>
                <button onclick="closeEventDetailsModal()" style="background: var(--accent-primary); color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                        onmouseover="this.style.background='var(--accent-secondary)'; this.style.transform='translateY(-2px)'"
                        onmouseout="this.style.background='var(--accent-primary)'; this.style.transform='translateY(0)'">
                    Close
                </button>
            </div>
        </div>
    </div>

    <!-- SESSION DETAILS MODAL (Phase C: Calendar Session Display) -->
    <div id="sessionDetailsModal" class="modal-overlay" style="display: none;">
        <div class="session-details-modal">
            <!-- Header with Game Image Background -->
            <div id="sessionDetailsHeader" class="session-details-header">
                <button class="session-close-btn" onclick="closeSessionDetailsModal()">âœ•</button>
                <div class="session-details-header-content">
                    <h2 id="sessionDetailsTitle" class="session-details-title">ğŸ® Game Session</h2>
                    <p id="sessionDetailsTime" class="session-details-time">Time info</p>
                </div>
            </div>
            
            <div class="session-details-body">
                <!-- Status Badge -->
                <div id="sessionStatusBadge" class="session-status-badge pending">
                    <span id="sessionStatusIcon">â³</span>
                    <span id="sessionStatusText">Pending</span>
                </div>
                
                <!-- Session Info Grid -->
                <div class="session-info-grid">
                    <div class="session-info-item">
                        <div class="session-info-label">ğŸ“Š Match Score</div>
                        <div id="sessionMatchPercent" class="session-info-value">--</div>
                    </div>
                    <div class="session-info-item">
                        <div class="session-info-label">â±ï¸ Duration</div>
                        <div id="sessionDuration" class="session-info-value">--</div>
                    </div>
                    <div class="session-info-item">
                        <div class="session-info-label">ğŸ­ Mood</div>
                        <div id="sessionMood" class="session-info-value">--</div>
                    </div>
                    <div class="session-info-item">
                        <div class="session-info-label">âš¡ Energy</div>
                        <div id="sessionEnergy" class="session-info-value">--</div>
                    </div>
                </div>
                
                <!-- Feedback Prompt (shown for past PENDING sessions) -->
                <div id="sessionFeedbackPrompt" class="session-feedback-prompt" style="display: none;">
                    <div class="session-feedback-prompt-icon">ğŸ“</div>
                    <p class="session-feedback-prompt-text">How was your session?</p>
                    <p class="session-feedback-prompt-subtext">Your feedback helps improve future recommendations</p>
                </div>
                
                <!-- Feedback Display (shown for COMPLETED sessions) -->
                <div id="sessionFeedbackDisplay" class="session-feedback-display" style="display: none;">
                    <div class="session-info-label" style="margin-bottom: 8px;">ğŸ“Š Your Feedback</div>
                    <div id="sessionRatingDisplay" class="session-rating-display"></div>
                    <div id="sessionEmotionalTags" class="session-emotional-tags"></div>
                </div>
                
                <!-- Notes (if any) -->
                <div id="sessionNotesSection" class="session-notes" style="display: none;">
                    <div class="session-notes-label">ğŸ’­ Notes</div>
                    <p id="sessionNotesText" class="session-notes-text"></p>
                </div>
                
                <!-- Actions -->
                <div class="session-details-actions">
                    <button id="sessionDeleteBtn" class="session-action-btn danger" onclick="deleteSessionFromCalendar()">
                        ğŸ—‘ï¸ Delete
                    </button>
                    <button id="sessionFeedbackBtn" class="session-action-btn primary" onclick="openFeedbackForSession()" style="display: none;">
                        ğŸ“ Add Feedback
                    </button>
                    <button class="session-action-btn secondary" onclick="closeSessionDetailsModal()">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- MAXIMIZED GAME MODAL (Global - works from all tabs) -->
    <div id="gameMaximizedOverlay" class="modal-overlay" style="display: none;">
        <div class="game-maximized-modal">
            <button class="modal-close-maximized" onclick="closeMaximizedGame()">âœ•</button>
            <div id="maximizedGameContent"></div>
        </div>
    </div>

    <!-- FEEDBACK SESSION MODAL (Phase D: Post-Session Feedback) -->
    <div id="feedbackSessionModal" class="modal-overlay" style="display: none;">
        <div class="feedback-modal">
            <button class="modal-close-btn" onclick="skipSessionFeedback()">âœ•</button>
            
            <!-- Modal Header -->
            <div class="feedback-modal-header">
                <h2>ğŸ® How was your session?</h2>
                <p id="feedbackScheduledTime" class="feedback-time-subtitle">Scheduled for today</p>
            </div>
            
            <!-- Game Preview -->
            <div class="feedback-game-preview">
                <img id="feedbackGameImage" src="" alt="Game cover" class="feedback-game-image">
                <div class="feedback-game-info">
                    <span id="feedbackGameName" class="feedback-game-name">Game Name</span>
                    <span id="feedbackGameGenre" class="feedback-genre-badge">Genre</span>
                </div>
            </div>
            
            <!-- Feedback Form -->
            <div class="feedback-form">
                <!-- Did You Play? -->
                <div class="feedback-field">
                    <label>Did you play this game?</label>
                    <div class="did-play-options">
                        <button type="button" class="did-play-option selected" data-value="YES" onclick="selectDidPlay('YES')">
                            <span>âœ…</span> Yes
                        </button>
                        <button type="button" class="did-play-option" data-value="NO" onclick="selectDidPlay('NO')">
                            <span>âŒ</span> No
                        </button>
                        <button type="button" class="did-play-option" data-value="DIFFERENT_GAME" onclick="selectDidPlay('DIFFERENT_GAME')">
                            <span>ğŸ”„</span> Different game
                        </button>
                    </div>
                </div>
                
                <!-- Fields shown when user played -->
                <div id="feedbackPlayedFields">
                    <!-- Duration Slider -->
                    <div class="feedback-field">
                        <label>How long did you play?</label>
                        <div class="duration-slider-container">
                            <input type="range" id="feedbackDuration" class="duration-slider" 
                                   min="5" max="180" value="30" step="5"
                                   oninput="updateDurationDisplay(this.value)">
                            <span id="feedbackDurationDisplay" class="duration-display">30 min</span>
                        </div>
                    </div>
                    
                    <!-- Star Rating -->
                    <div class="feedback-field">
                        <label>Rate your experience</label>
                        <div class="star-rating">
                            <button type="button" class="feedback-star" onclick="selectStarRating(1)">â­</button>
                            <button type="button" class="feedback-star" onclick="selectStarRating(2)">â­</button>
                            <button type="button" class="feedback-star" onclick="selectStarRating(3)">â­</button>
                            <button type="button" class="feedback-star" onclick="selectStarRating(4)">â­</button>
                            <button type="button" class="feedback-star" onclick="selectStarRating(5)">â­</button>
                        </div>
                    </div>
                    
                    <!-- Emotional Tags -->
                    <div class="feedback-field">
                        <label>How did it make you feel? <span class="field-hint">(select all that apply)</span></label>
                        <div class="emotional-tags">
                            <button type="button" class="emotional-tag" data-tag="RELAXING" onclick="toggleEmotionalTag(this)">
                                ğŸ˜Œ Relaxing
                            </button>
                            <button type="button" class="emotional-tag" data-tag="ENERGIZING" onclick="toggleEmotionalTag(this)">
                                âš¡ Energizing
                            </button>
                            <button type="button" class="emotional-tag" data-tag="SATISFYING" onclick="toggleEmotionalTag(this)">
                                ğŸ˜Š Satisfying
                            </button>
                            <button type="button" class="emotional-tag" data-tag="FRUSTRATING" onclick="toggleEmotionalTag(this)">
                                ğŸ˜¤ Frustrating
                            </button>
                            <button type="button" class="emotional-tag" data-tag="CHALLENGING" onclick="toggleEmotionalTag(this)">
                                ğŸ’ª Challenging
                            </button>
                            <button type="button" class="emotional-tag" data-tag="FUN" onclick="toggleEmotionalTag(this)">
                                ğŸ‰ Fun
                            </button>
                        </div>
                    </div>
                    
                    <!-- Notes (optional) -->
                    <div class="feedback-field">
                        <label>Any notes? <span class="field-hint">(optional)</span></label>
                        <textarea id="feedbackNotes" class="feedback-notes" placeholder="How was the recommendation? Any thoughts..." rows="2"></textarea>
                    </div>
                </div>
                
                <!-- Message shown when user didn't play -->
                <div id="feedbackNotPlayedMessage" style="display: none;">
                    <div class="not-played-message">
                        <span>ğŸ˜”</span>
                        <p>No worries! We'll mark this session and improve future recommendations.</p>
                    </div>
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="feedback-modal-footer">
                <button type="button" class="btn-secondary" onclick="skipSessionFeedback()">Skip</button>
                <button type="button" class="btn-primary feedback-submit-btn" onclick="submitSessionFeedback()">
                    <span>âœ“</span> Submit Feedback
                </button>
            </div>
        </div>
    </div>

    <!-- SCHEDULE SESSION MODAL (Phase B: Schedule from Home) -->
    <div id="scheduleSessionModal" class="modal-overlay" style="display: none;">
        <div class="schedule-modal">
            <button class="modal-close-btn" onclick="closeScheduleModal()">âœ•</button>
            
            <!-- Modal Header -->
            <div class="schedule-modal-header">
                <h2>ğŸ“… Schedule Gaming Session</h2>
                <p id="scheduleGameName" class="schedule-game-subtitle">Game Name</p>
            </div>
            
            <!-- Game Preview -->
            <div class="schedule-game-preview">
                <img id="scheduleGameImage" src="" alt="Game cover" class="schedule-game-image">
                <div class="schedule-game-info">
                    <span id="scheduleGameGenre" class="schedule-genre-badge">Genre</span>
                    <span id="scheduleMatchPercent" class="schedule-match-badge">95% Match</span>
                </div>
            </div>
            
            <!-- Schedule Form -->
            <div class="schedule-form">
                <!-- Date Picker -->
                <div class="schedule-field">
                    <label for="scheduleDate">ğŸ“† Date</label>
                    <input type="date" id="scheduleDate" required>
                </div>
                
                <!-- Time Picker -->
                <div class="schedule-field">
                    <label for="scheduleTime">ğŸ• Start Time</label>
                    <input type="time" id="scheduleTime" required>
                </div>
                
                <!-- Duration -->
                <div class="schedule-field">
                    <label for="scheduleDuration">â±ï¸ Duration (minutes)</label>
                    <input type="number" id="scheduleDuration" min="5" max="480" value="30" required>
                    <span class="schedule-duration-hint" id="scheduleDurationHint">Typical: 30-60 min</span>
                </div>
                
                <!-- Quick Actions -->
                <div class="schedule-quick-actions">
                    <button type="button" class="schedule-quick-btn" onclick="schedulePlayNow()">
                        <span>â–¶ï¸</span> Play Now
                    </button>
                    <button type="button" class="schedule-quick-btn" onclick="scheduleNextHour()">
                        <span>â°</span> Next Hour
                    </button>
                    <button type="button" class="schedule-quick-btn" onclick="scheduleTomorrow()">
                        <span>ğŸ“…</span> Tomorrow
                    </button>
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="schedule-modal-footer">
                <button type="button" class="btn-secondary" onclick="closeScheduleModal()">Cancel</button>
                <button type="button" class="btn-primary schedule-confirm-btn" onclick="confirmScheduleSession()">
                    <span>âœ“</span> Schedule Session
                </button>
            </div>
        </div>
    </div>

    <!-- ICS IMPORT MODAL -->
    <div id="importModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 500px; width: 95%;">
            <div class="modal-header">
                <h2 style="color: var(--text-primary); font-size: 1.6em; margin: 0;">ğŸ“¥ Import Calendar</h2>
                <button onclick="closeImportModal()" class="modal-close-btn">âœ•</button>
            </div>
            
            <div style="padding: 20px;">
                <!-- Instructions -->
                <div style="background: var(--bg-main); padding: 16px; border-radius: 12px; margin-bottom: 20px;">
                    <p style="color: var(--text-secondary); font-size: 0.95em; margin: 0 0 10px 0;">
                        <strong>How to export from Google Calendar:</strong>
                    </p>
                    <ol style="color: var(--text-secondary); font-size: 0.9em; margin: 0; padding-left: 20px;">
                        <li>Go to <a href="https://calendar.google.com/calendar/r/settings/export" target="_blank" style="color: var(--accent-primary);">Google Calendar Settings â†’ Export</a></li>
                        <li>Click "Export" to download a .zip file</li>
                        <li>Extract the .ics file and upload it below</li>
                    </ol>
                </div>
                
                <!-- File Upload Area -->
                <div id="importDropZone" class="import-drop-zone" 
                     ondrop="handleFileDrop(event)" 
                     ondragover="handleDragOver(event)"
                     ondragleave="handleDragLeave(event)"
                     onclick="document.getElementById('icsFileInput').click()">
                    <input type="file" id="icsFileInput" accept=".ics" style="display: none;" onchange="handleFileSelect(event)">
                    <span style="font-size: 3em;">ğŸ“</span>
                    <p style="color: var(--text-primary); font-weight: 600; margin: 10px 0 5px;">Drop .ics file here</p>
                    <p style="color: var(--text-secondary); font-size: 0.9em; margin: 0;">or click to browse</p>
                </div>
                
                <!-- Import Preview (hidden by default) -->
                <div id="importPreview" style="display: none; margin-top: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                        <span style="color: var(--text-primary); font-weight: 600;">Events to import:</span>
                        <span id="importCount" style="background: var(--accent-primary); color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.9em;">0</span>
                    </div>
                    <div id="importEventsList" style="max-height: 200px; overflow-y: auto; background: var(--bg-main); border-radius: 12px; padding: 12px;"></div>
                </div>
                
                <!-- Import Status -->
                <div id="importStatus" style="display: none; margin-top: 20px; padding: 16px; border-radius: 12px; text-align: center;"></div>
                
                <!-- Action Buttons -->
                <div style="display: flex; gap: 12px; margin-top: 20px;">
                    <button onclick="closeImportModal()" class="btn-secondary" style="flex: 1;">Cancel</button>
                    <button id="importConfirmBtn" onclick="confirmImport()" class="btn-save" style="flex: 1;" disabled>
                        <span>ğŸ“¥</span>
                        <span>Import Events</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ENHANCED ADD EVENT MODAL (Task + Gaming Session) -->
    <div id="addEventModal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="max-width: 550px; width: 95%;">
            <!-- Modal Header -->
            <div class="modal-header">
                <h2 style="color: var(--text-primary); font-size: 1.6em; margin: 0;">Add to Calendar</h2>
                <button onclick="closeAddEventModal()" class="modal-close-btn">âœ•</button>
            </div>
            
            <!-- Tab Switcher -->
            <div class="event-type-tabs">
                <button class="event-tab active" data-type="task" onclick="switchEventTab('task')">
                    <span class="tab-icon">ğŸ“‹</span>
                    <span>Task</span>
                </button>
                <button class="event-tab" data-type="gaming" onclick="switchEventTab('gaming')">
                    <span class="tab-icon">ğŸ®</span>
                    <span>Gaming Session</span>
                </button>
            </div>
            
            <!-- Shared Time Fields -->
            <div class="event-time-fields">
                <div class="time-field-row">
                    <div class="time-field">
                        <label>ğŸ• Start Time</label>
                        <input type="datetime-local" id="eventStartTime" required>
                    </div>
                    <div class="time-field">
                        <label>ğŸ• End Time</label>
                        <input type="datetime-local" id="eventEndTime" required>
                    </div>
                </div>
                <div class="duration-display" id="eventDurationDisplay">Duration: --</div>
            </div>
            
            <!-- TASK TAB CONTENT -->
            <div id="taskTabContent" class="event-tab-content active">
                <div class="form-field">
                    <label>ğŸ“‹ Task Title</label>
                    <input type="text" id="eventTaskTitle" placeholder="e.g., Team Meeting, Exercise, Study Session" required>
                </div>
                <div class="form-field">
                    <label>ğŸ“ Description (optional)</label>
                    <textarea id="eventTaskDescription" rows="3" placeholder="Add details about your task..."></textarea>
                </div>
            </div>
            
            <!-- GAMING SESSION TAB CONTENT -->
            <div id="gamingTabContent" class="event-tab-content" style="display: none;">
                <!-- Game Selection Mode Tabs -->
                <div class="game-selection-modes">
                    <button class="game-mode-btn active" data-mode="browse" onclick="switchGameMode('browse')">
                        ğŸ“š Browse Library
                    </button>
                    <button class="game-mode-btn" data-mode="wizard" onclick="switchGameMode('wizard')">
                        ğŸ§™ Let Lutem Choose
                    </button>
                    <button class="game-mode-btn" data-mode="random" onclick="switchGameMode('random')">
                        ğŸ² Surprise Me
                    </button>
                </div>
                
                <!-- Browse Library Mode -->
                <div id="gameBrowseMode" class="game-mode-content active">
                    <div class="game-search-container">
                        <input type="text" id="eventGameSearch" placeholder="ğŸ” Search your games..." oninput="filterEventGames()">
                    </div>
                    <div class="game-list-container" id="eventGameList">
                        <!-- Games will be loaded here dynamically -->
                        <div class="loading-games">Loading games...</div>
                    </div>
                    <div class="selected-game-display" id="selectedGameDisplay" style="display: none;">
                        <div class="selected-game-label">Selected:</div>
                        <div class="selected-game-info">
                            <img id="selectedGameCover" src="" alt="">
                            <span id="selectedGameName"></span>
                            <button class="clear-selection-btn" onclick="clearGameSelection()">âœ•</button>
                        </div>
                    </div>
                </div>
                
                <!-- Wizard Mode -->
                <div id="gameWizardMode" class="game-mode-content" style="display: none;">
                    <!-- Step 1: Quick Preferences -->
                    <div id="wizardStep1" class="wizard-step active">
                        <div class="wizard-step-header">
                            <span class="wizard-step-icon">ğŸ¯</span>
                            <span class="wizard-step-title">What are you in the mood for?</span>
                        </div>
                        
                        <!-- Mood Selection -->
                        <div class="wizard-mood-grid">
                            <button type="button" class="wizard-mood-chip" data-mood="UNWIND" onclick="toggleCalendarMood(this)">
                                <span class="mood-emoji">ğŸ˜Œ</span>
                                <span class="mood-label">Unwind</span>
                            </button>
                            <button type="button" class="wizard-mood-chip" data-mood="RECHARGE" onclick="toggleCalendarMood(this)">
                                <span class="mood-emoji">ğŸ”‹</span>
                                <span class="mood-label">Recharge</span>
                            </button>
                            <button type="button" class="wizard-mood-chip" data-mood="ENGAGE" onclick="toggleCalendarMood(this)">
                                <span class="mood-emoji">ğŸ”¥</span>
                                <span class="mood-label">Engage</span>
                            </button>
                            <button type="button" class="wizard-mood-chip" data-mood="CHALLENGE" onclick="toggleCalendarMood(this)">
                                <span class="mood-emoji">ğŸ¯</span>
                                <span class="mood-label">Challenge</span>
                            </button>
                            <button type="button" class="wizard-mood-chip" data-mood="EXPLORE" onclick="toggleCalendarMood(this)">
                                <span class="mood-emoji">ğŸŒ</span>
                                <span class="mood-label">Explore</span>
                            </button>
                            <button type="button" class="wizard-mood-chip" data-mood="PROGRESS_ORIENTED" onclick="toggleCalendarMood(this)">
                                <span class="mood-emoji">ğŸ“ˆ</span>
                                <span class="mood-label">Progress</span>
                            </button>
                        </div>
                        
                        <!-- Energy Level -->
                        <div class="wizard-energy-section">
                            <span class="wizard-field-label">âš¡ Energy Level</span>
                            <div class="wizard-energy-options">
                                <button type="button" class="wizard-energy-btn" data-energy="LOW" onclick="selectCalendarEnergy(this)">
                                    ğŸª« Low
                                </button>
                                <button type="button" class="wizard-energy-btn selected" data-energy="MEDIUM" onclick="selectCalendarEnergy(this)">
                                    âš¡ Medium
                                </button>
                                <button type="button" class="wizard-energy-btn" data-energy="HIGH" onclick="selectCalendarEnergy(this)">
                                    ğŸ”‹ High
                                </button>
                            </div>
                        </div>
                        
                        <!-- Get Recommendations Button -->
                        <button type="button" class="wizard-recommend-btn" onclick="getCalendarRecommendations()">
                            <span>ğŸ§™</span> Find Games for This Session
                        </button>
                    </div>
                    
                    <!-- Step 2: Results -->
                    <div id="wizardStep2" class="wizard-step" style="display: none;">
                        <div class="wizard-step-header">
                            <button type="button" class="wizard-back-btn" onclick="showWizardStep1()">â† Back</button>
                            <span class="wizard-step-title">Pick a game</span>
                        </div>
                        
                        <!-- Loading State -->
                        <div id="wizardLoading" class="wizard-loading" style="display: none;">
                            <div class="wizard-spinner"></div>
                            <p>Finding perfect games...</p>
                        </div>
                        
                        <!-- Results Grid -->
                        <div id="wizardResults" class="wizard-results-grid">
                            <!-- Recommendation cards will be inserted here -->
                        </div>
                    </div>
                </div>
                
                <!-- Random Mode -->
                <div id="gameRandomMode" class="game-mode-content" style="display: none;">
                    <!-- Initial State: Roll Button -->
                    <div id="randomInitialState" class="random-roll-container">
                        <div class="random-dice-icon">ğŸ²</div>
                        <h3 class="random-title">Feeling Lucky?</h3>
                        <p class="random-subtitle">Let fate decide your next gaming adventure!</p>
                        <button type="button" class="random-roll-btn" onclick="rollRandomGame()">
                            <span class="roll-btn-icon">ğŸ²</span>
                            <span>Roll the Dice!</span>
                        </button>
                        <p class="random-hint" id="randomTimeHint"></p>
                    </div>
                    
                    <!-- Result State: Show Selected Game -->
                    <div id="randomResultState" class="random-result-container" style="display: none;">
                        <div class="random-result-header">
                            <span class="sparkle">âœ¨</span>
                            <span>Your Random Pick!</span>
                            <span class="sparkle">âœ¨</span>
                        </div>
                        <div class="random-game-card">
                            <img id="randomGameImage" class="random-game-image" src="" alt="Game cover">
                            <div class="random-game-info">
                                <div id="randomGameName" class="random-game-name"></div>
                                <div id="randomGameGenre" class="random-game-genre"></div>
                                <div class="random-game-meta">
                                    <span id="randomGameTime">â±ï¸ --</span>
                                    <span id="randomGameEnergy">âš¡ --</span>
                                </div>
                            </div>
                        </div>
                        <div class="random-actions">
                            <button type="button" class="random-reroll-btn" onclick="rollRandomGame()">
                                <span>ğŸ”„</span>
                                <span>Re-roll</span>
                            </button>
                            <button type="button" class="random-accept-btn" onclick="acceptRandomGame()">
                                <span>âœ“</span>
                                <span>Use This Game</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" onclick="closeAddEventModal()" class="btn-secondary">Cancel</button>
                <button type="button" onclick="saveCalendarEvent()" class="btn-primary" id="saveEventBtn">
                    <span id="saveEventBtnText">âœ“ Add Task</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ADD TASK MODAL (Legacy - kept for reference) -->
    <div id="addTaskModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; align-items: center; justify-content: center;">
        <div style="background: var(--surface); border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h2 style="color: var(--text-primary); font-size: 1.8em; margin: 0;">Add New Task</h2>
                <button onclick="closeAddTaskModal()" style="background: none; border: none; font-size: 1.5em; cursor: pointer; color: var(--text-secondary); padding: 5px 10px; border-radius: 8px; transition: all 0.3s;"
                        onmouseover="this.style.background='var(--bg-main)'"
                        onmouseout="this.style.background='none'">âœ•</button>
            </div>
            
            <form id="addTaskForm" onsubmit="saveTask(event)">
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                        ğŸ“‹ Task Title
                    </label>
                    <input type="text" id="taskTitle" required 
                           placeholder="e.g., Team Meeting, Exercise, Study Session"
                           style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em;">
                </div>
                
                <div style="margin-bottom: 20px;">
                    <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                        ğŸ“ Description (optional)
                    </label>
                    <textarea id="taskDescription" rows="3" 
                              placeholder="Add details about your task..."
                              style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em; resize: vertical;"></textarea>
                </div>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 25px;">
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ• Start Time
                        </label>
                        <input type="datetime-local" id="taskStart" required 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em;">
                    </div>
                    
                    <div>
                        <label style="display: block; color: var(--text-secondary); font-size: 0.9em; margin-bottom: 8px; font-weight: 500;">
                            ğŸ• End Time
                        </label>
                        <input type="datetime-local" id="taskEnd" required 
                               style="width: 100%; padding: 12px; border: 2px solid var(--border); border-radius: 10px; background: var(--background); color: var(--text-primary); font-size: 0.95em;">
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="closeAddTaskModal()" style="background: var(--bg-main); color: var(--text-primary); border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                            onmouseover="this.style.background='var(--border)'"
                            onmouseout="this.style.background='var(--bg-main)'">
                        Cancel
                    </button>
                    <button type="submit" style="background: var(--accent-primary); color: white; border: none; padding: 12px 24px; border-radius: 12px; font-weight: 600; cursor: pointer; transition: all 0.3s;"
                            onmouseover="this.style.background='var(--accent-secondary)'; this.style.transform='translateY(-2px)'"
                            onmouseout="this.style.background='var(--accent-primary)'; this.style.transform='translateY(0)'">
                        âœ“ Add Task
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- AUTH MODAL -->
    <div id="authModal" class="modal-overlay" style="display: none;">
        <div class="auth-modal">
            <button class="auth-modal-close" onclick="closeAuthModal()">âœ•</button>
            
            <div class="auth-modal-header">
                <div class="auth-logo">ğŸ®</div>
                <h2 id="authModalTitle">Welcome to Lutem</h2>
                <p class="auth-subtitle">Sign in to unlock all features</p>
            </div>
            
            <!-- Error Message -->
            <div id="authError" class="auth-error" style="display: none;"></div>
            
            <!-- Sign In Section -->
            <div id="authSignInSection">
                <!-- Google Sign In -->
                <button class="auth-google-btn" onclick="signInWithGoogle()">
                    <svg width="20" height="20" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    <span>Continue with Google</span>
                </button>
                
                <div class="auth-divider">
                    <span>or</span>
                </div>
                
                <!-- Email Sign In Form -->
                <form id="signInForm" onsubmit="handleSignIn(event)">
                    <div class="auth-field">
                        <label for="authEmail">Email</label>
                        <input type="email" id="authEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="auth-field">
                        <label for="authPassword">Password</label>
                        <input type="password" id="authPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                    </div>
                    <button type="submit" class="auth-submit-btn">Sign In</button>
                </form>
                
                <p class="auth-switch">
                    Don't have an account? 
                    <a href="#" onclick="switchAuthMode('signup'); return false;">Sign up</a>
                </p>
            </div>
            
            <!-- Sign Up Section (hidden by default) -->
            <div id="authSignUpSection" style="display: none;">
                <!-- Google Sign Up -->
                <button class="auth-google-btn" onclick="signInWithGoogle()">
                    <svg width="20" height="20" viewBox="0 0 24 24">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    <span>Continue with Google</span>
                </button>
                
                <div class="auth-divider">
                    <span>or</span>
                </div>
                
                <!-- Email Sign Up Form -->
                <form id="signUpForm" onsubmit="handleSignUp(event)">
                    <div class="auth-field">
                        <label for="authDisplayName">Display Name (optional)</label>
                        <input type="text" id="authDisplayName" placeholder="Your name">
                    </div>
                    <div class="auth-field">
                        <label for="authSignUpEmail">Email</label>
                        <input type="email" id="authSignUpEmail" placeholder="your@email.com" required>
                    </div>
                    <div class="auth-field">
                        <label for="authSignUpPassword">Password</label>
                        <input type="password" id="authSignUpPassword" placeholder="At least 6 characters" required>
                    </div>
                    <div class="auth-field">
                        <label for="authSignUpConfirmPassword">Confirm Password</label>
                        <input type="password" id="authSignUpConfirmPassword" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required>
                    </div>
                    <button type="submit" class="auth-submit-btn">Create Account</button>
                </form>
                
                <p class="auth-switch">
                    Already have an account? 
                    <a href="#" onclick="switchAuthMode('signin'); return false;">Sign in</a>
                </p>
            </div>
        </div>
    </div>

    <!-- External JavaScript Modules (loaded in dependency order) -->
    <!-- Config module (MUST load first - provides API_URL for all other modules) -->
    <script src="js/config.js"></script>
    
    <!-- Core modules (no dependencies except config) -->
    <script src="js/constants.js"></script>
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    
    <!-- UI modules (depend on core) -->
    <script src="js/theme.js"></script>
    <script src="js/wizard.js"></script>
    <script src="js/form.js"></script>
    <script src="js/validation.js"></script>
    
    <!-- Feature modules (depend on core + UI) -->
    <script src="js/api.js"></script>
    <script src="js/firestore.js"></script>
    <script src="js/satisfaction-stats.js"></script>
    <script src="js/feedback.js"></script>
    <script src="js/recommendation.js"></script>
    <script src="js/weekly-summary.js"></script>
    <script src="js/tabs.js"></script>
    <script src="js/games-library.js"></script>
    <script src="js/profile.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/auth.js"></script>
    
    <!-- Main init (depends on all above) -->
    <script src="js/main.js"></script>

</body>
</html>
